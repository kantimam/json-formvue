{"remainingRequest":"/Users/k.imamov/Desktop/json-formvue/json-formvue/node_modules/thread-loader/dist/cjs.js!/Users/k.imamov/Desktop/json-formvue/json-formvue/node_modules/babel-loader/lib/index.js!/Users/k.imamov/Desktop/json-formvue/json-formvue/src/store/index.js","dependencies":[{"path":"/Users/k.imamov/Desktop/json-formvue/json-formvue/src/store/index.js","mtime":1631895714991},{"path":"/Users/k.imamov/Desktop/json-formvue/json-formvue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k.imamov/Desktop/json-formvue/json-formvue/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k.imamov/Desktop/json-formvue/json-formvue/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMvay5pbWFtb3YvRGVza3RvcC9qc29uLWZvcm12dWUvanNvbi1mb3JtdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvay5pbWFtb3YvRGVza3RvcC9qc29uLWZvcm12dWUvanNvbi1mb3JtdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucHJvbWlzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5mcmVlemUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVnVleCBmcm9tICd2dWV4JzsKaW1wb3J0IHsgY3JlYXRlQ2FsbGJhY2tMaXN0IH0gZnJvbSAnLi4vbGliL3V0aWwnOwpWdWUudXNlKFZ1ZXgpOwovKiBsb29rIGludG8gc3BsaXR0aW5nIHNpbmdsZSBzdGVwIGFuZCBtdWx0aWUgc3RlcCBpbnRvIGRpZmZlcmVudCBtb2R1bGVzIGFuZCBjb25kaXRpb25hbGx5IGFkZGluZyB0aGVtIGlmIG5lZWRlZCAqLwoKdmFyIGNyZWF0ZVN0b3JlID0gZnVuY3Rpb24gY3JlYXRlU3RvcmUoaW5pdGlhbFN0YXRlKSB7CiAgdmFyIGRlYnVnID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJzsKICByZXR1cm4gbmV3IFZ1ZXguU3RvcmUoewogICAgc3RhdGU6IGluaXRGb3JtU3RhdGVGcm9tRXh0ZW5kZWRGb3JtKGluaXRpYWxTdGF0ZSksCiAgICBzdHJpY3Q6IGRlYnVnLAogICAgZ2V0dGVyczogewogICAgICBnZXRDdXJyZW50U3RlcDogZnVuY3Rpb24gZ2V0Q3VycmVudFN0ZXAoc3RhdGUpIHsKICAgICAgICB2YXIgdmFsaWRJbmRleCA9IHN0YXRlLmN1cnJlbnRTdGVwID8gc3RhdGUuY3VycmVudFN0ZXAgLSAxIDogMDsKICAgICAgICByZXR1cm4gc3RhdGUuc3RlcHNbdmFsaWRJbmRleF07CiAgICAgIH0sCiAgICAgIGdldElzU2luZ2xlU3RlcDogZnVuY3Rpb24gZ2V0SXNTaW5nbGVTdGVwKHN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlLmxhc3RTdGVwID09PSAxOwogICAgICB9LAogICAgICBnZXRJc0xhc3RTdGVwOiBmdW5jdGlvbiBnZXRJc0xhc3RTdGVwKHN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlLmN1cnJlbnRTdGVwID09PSBzdGF0ZS5sYXN0U3RlcDsKICAgICAgfSwKICAgICAgZ2V0Q3VycmVudFNjaGVtYTogZnVuY3Rpb24gZ2V0Q3VycmVudFNjaGVtYShfLCBnZXR0ZXJzKSB7CiAgICAgICAgcmV0dXJuIGdldHRlcnMuZ2V0Q3VycmVudFN0ZXAuc2NoZW1hOwogICAgICB9LAogICAgICBnZXRDdXJyZW50TW9kZWw6IGZ1bmN0aW9uIGdldEN1cnJlbnRNb2RlbChfLCBnZXR0ZXJzKSB7CiAgICAgICAgcmV0dXJuIGdldHRlcnMuZ2V0Q3VycmVudFN0ZXAuaW5wdXRNb2RlbDsKICAgICAgfSwKICAgICAgZ2V0Q3VycmVudElucHV0VmFsdWU6IGZ1bmN0aW9uIGdldEN1cnJlbnRJbnB1dFZhbHVlKF8sIGdldHRlcnMpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0S2V5KSB7CiAgICAgICAgICB2YXIgbW9kZWwgPSBnZXR0ZXJzLmdldEN1cnJlbnRNb2RlbDsKICAgICAgICAgIGlmICghbW9kZWwpIHJldHVybiAiIjsKICAgICAgICAgIHZhciBpbnB1dE1vZGVsID0gbW9kZWxbaW5wdXRLZXldOwogICAgICAgICAgaWYgKCFpbnB1dE1vZGVsIHx8ICFpbnB1dE1vZGVsLnZhbHVlKSByZXR1cm4gIiI7CiAgICAgICAgICByZXR1cm4gaW5wdXRNb2RlbC52YWx1ZTsKICAgICAgICB9OwogICAgICB9LAogICAgICBnZXRDdXJyZW50SW5wdXROYW1lOiBmdW5jdGlvbiBnZXRDdXJyZW50SW5wdXROYW1lKF8sIGdldHRlcnMpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGlucHV0S2V5KSB7CiAgICAgICAgICB2YXIgc3RlcCA9IGdldHRlcnMuZ2V0Q3VycmVudFN0ZXA7CiAgICAgICAgICBpZiAoIXN0ZXAgfHwgIXN0ZXAuZm9ybUlkKSByZXR1cm4gInR4X2Zvcm1fZm9ybWZyYW1ld29ya1siLmNvbmNhdChpbnB1dEtleSwgIl0iKTsKICAgICAgICAgIHJldHVybiAidHhfZm9ybV9mb3JtZnJhbWV3b3JrWyIuY29uY2F0KHN0ZXAuZm9ybUlkLCAiXVsiKS5jb25jYXQoaW5wdXRLZXksICJdIik7CiAgICAgICAgfTsKICAgICAgfQogICAgfSwKICAgIG11dGF0aW9uczogewogICAgICB1cGRhdGVJbnB1dFZhbHVlOiBmdW5jdGlvbiB1cGRhdGVJbnB1dFZhbHVlKHN0YXRlLCBwYXlsb2FkKSB7CiAgICAgICAgY29uc29sZS5sb2cocGF5bG9hZCk7CiAgICAgICAgdmFyIHZhbGlkSW5kZXggPSBzdGF0ZS5jdXJyZW50U3RlcCA/IHN0YXRlLmN1cnJlbnRTdGVwIC0gMSA6IDA7CiAgICAgICAgdmFyIGN1cnJlbnRTdGVwID0gc3RhdGUuc3RlcHNbdmFsaWRJbmRleF07CiAgICAgICAgaWYgKCFjdXJyZW50U3RlcCkgcmV0dXJuIGNvbnNvbGUubG9nKCJjb3VsZCBub3QgZmluZCB0aGUgc3RlcCAiLmNvbmNhdChzdGF0ZS5jdXJyZW50U3RlcCwgIiBhdCB0aGUgaW5kZXggIikuY29uY2F0KHZhbGlkSW5kZXgpKTsKICAgICAgICB2YXIgY3VycmVudE1vZGVsID0gY3VycmVudFN0ZXAuaW5wdXRNb2RlbFtwYXlsb2FkLmtleV07CiAgICAgICAgaWYgKCFjdXJyZW50TW9kZWwpIHJldHVybiBjb25zb2xlLmxvZygidGhlIG1vZGVsIGRvZXMgbm90IGhhdmUgYSBmaWVsZCB3aXRoIHRoZSBrZXkgIi5jb25jYXQocGF5bG9hZC5rZXkpKTsKICAgICAgICBjdXJyZW50TW9kZWwudmFsdWUgPSBwYXlsb2FkLnZhbHVlOwogICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbnRNb2RlbCk7CiAgICAgIH0sCiAgICAgIHVwZGF0ZUZvcm1TdGVwOiBmdW5jdGlvbiB1cGRhdGVGb3JtU3RlcChzdGF0ZSwgbmV3U3RlcCkgewogICAgICAgIHN0YXRlLmN1cnJlbnRTdGVwID0gbmV3U3RlcCA+IDAgPyBuZXdTdGVwIDogMTsKICAgICAgfSwKICAgICAgc2V0Rm9ybVJlc3BvbnNlOiBmdW5jdGlvbiBzZXRGb3JtUmVzcG9uc2Uoc3RhdGUsIHJlc3BvbnNlKSB7CiAgICAgICAgc3RhdGUuZm9ybVJlc3BvbnNlID0gcmVzcG9uc2U7CiAgICAgIH0sCiAgICAgIHNldEZvcm1GaW5pc2hlZDogZnVuY3Rpb24gc2V0Rm9ybUZpbmlzaGVkKHN0YXRlKSB7CiAgICAgICAgc3RhdGUuZm9ybUZpbmlzaGVkID0gdHJ1ZTsKICAgICAgfSwKICAgICAgc2V0Rm9ybVN0ZXA6IGZ1bmN0aW9uIHNldEZvcm1TdGVwKHN0YXRlLCBmb3JtQ29uZmlnKSB7CiAgICAgICAgdmFyIGZvcm1Db25maWdTdGVwID0gZm9ybUNvbmZpZy5hcGkucGFnZS5jdXJyZW50ID4gMCA/IGZvcm1Db25maWcuYXBpLnBhZ2UuY3VycmVudCA6IDE7CiAgICAgICAgc3RhdGUuaWQgPSBmb3JtQ29uZmlnLmlkOwogICAgICAgIHN0YXRlLmN1cnJlbnRTdGVwID0gZm9ybUNvbmZpZy5hcGkucGFnZS5jdXJyZW50IHx8IDE7CiAgICAgICAgc3RhdGUubmV4dFN0ZXAgPSBmb3JtQ29uZmlnLmFwaS5wYWdlLm5leHRQYWdlIHx8IDE7CiAgICAgICAgc3RhdGUucHJldmlvdXNTdGVwID0gZm9ybUNvbmZpZy5hcGkucGFnZS5wcmV2aW91c1BhZ2UgfHwgMTsKICAgICAgICBzdGF0ZS5sYXN0U3RlcCA9IGZvcm1Db25maWcuYXBpLnBhZ2UucGFnZXMgfHwgMTsKICAgICAgICBzdGF0ZS5mb3JtUmVzcG9uc2UgPSBudWxsOwogICAgICAgIHN0YXRlLnN0ZXBzW2Zvcm1Db25maWdTdGVwIC0gMV0gPSBjcmVhdGVTdGVwRnJvbUZvcm1Db25maWcoZm9ybUNvbmZpZyk7CiAgICAgIH0KICAgIH0sCiAgICBhY3Rpb25zOiB7CiAgICAgIHN1Ym1pdFN0ZXA6IGZ1bmN0aW9uIHN1Ym1pdFN0ZXAoY29udGV4dCwgdnVldGlmeUZvcm0pIHsKICAgICAgICB2YXIgaXNGb3JtVmFsaWQgPSB2dWV0aWZ5Rm9ybS52YWxpZGF0ZSgpOwoKICAgICAgICBpZiAodnVldGlmeUZvcm0uJGVsICYmIGlzRm9ybVZhbGlkKSB7CiAgICAgICAgICAvLyBjaGVjayBpZiBmb3JtIGVsZW1lbnQgZXhpc3RzIGFuZCBpZiBpdCBpcyB2YWxpZAogICAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKHZ1ZXRpZnlGb3JtLiRlbCk7IC8vIHBhcnNlIGZvcm1kYXRhIGZyb20gdW5kZXJseWluZyBmb3JtIGVsZW1lbnQKCiAgICAgICAgICB2YXIgY3VycmVudE1vZGVsID0gY29udGV4dC5nZXR0ZXJzLmdldEN1cnJlbnRNb2RlbDsKICAgICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbnRNb2RlbCk7IC8vIGFwcGVuZCBlbnRyaWVzIHRvIGZvcm1kYXRhCgogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGNvbnRleHQuZ2V0dGVycy5nZXRDdXJyZW50SW5wdXROYW1lKCdfX2N1cnJlbnRQYWdlJyksIGN1cnJlbnRNb2RlbFsnX19jdXJyZW50UGFnZSddLnZhbHVlKTsKICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgndHhfZm9ybV9mb3JtZnJhbWV3b3JrW19fdHJ1c3RlZFByb3BlcnRpZXNdJywgY3VycmVudE1vZGVsWydfX3RydXN0ZWRQcm9wZXJ0aWVzJ10udmFsdWUpOwogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGNvbnRleHQuZ2V0dGVycy5nZXRDdXJyZW50SW5wdXROYW1lKCdfX3N0YXRlJyksIGN1cnJlbnRNb2RlbFsnX19zdGF0ZSddLnZhbHVlKTsKICAgICAgICAgIHZhciBjdXJyZW50QWN0aW9uID0gY29udGV4dC5nZXR0ZXJzLmdldEN1cnJlbnRTdGVwLmZvcm1BY3Rpb247CiAgICAgICAgICBpZiAoIWN1cnJlbnRBY3Rpb24pIHJldHVybiBjb25zb2xlLmxvZygiY291bGQgbm90IGZpbmQgdmFsaWQgYWN0aW9uIGZvciB0aGUgY3VycmVudCBzdGVwIik7CiAgICAgICAgICBmZXRjaChjdXJyZW50QWN0aW9uLCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBib2R5OiBmb3JtRGF0YQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwIHx8IHJlc3BvbnNlLnN0YXR1cyA9PT0gMzAxKSByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgc3RhdHVzIGNvZGUuIE9ubHkgMjAwIGFuZCAzMDEgYWxsb3dlZCcpOwogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoanNvbikgewogICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgnaGFuZGxlU3VjY2Vzc1Jlc3BvbnNlJywganNvbik7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgLy8gZG9lcyBub3QgY2F0Y2ggaGFuZGxlU3VjY2Vzc1Jlc3BvbnNlIGVycm9ycwogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgIGNvbnRleHQuY29tbWl0KCdzZXRGb3JtUmVzcG9uc2UnLCAiPGgxPnJlcXVlc3QgZmFpbGVkPC9oMT5cbiAgICAgICAgICAgICAgICA8aDI+Ii5jb25jYXQoZXJyb3IubWVzc2FnZSwgIjwvaDI+IikpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBoYW5kbGVTdWNjZXNzUmVzcG9uc2U6IGZ1bmN0aW9uIGhhbmRsZVN1Y2Nlc3NSZXNwb25zZShjb250ZXh0LCBzdWNjZXNzSnNvbikgewogICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQyKSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN1Y2Nlc3NKc29uKTsKCiAgICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzSnNvbikgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgZmluZCB2YWxpZCBqc29uJyk7CgogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICBpZiAoIShzdWNjZXNzSnNvbi5zdGF0dXMgPT09IDMwMSAmJiBzdWNjZXNzSnNvbi5yZWRpcmVjdFVyaSkpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHN1Y2Nlc3NKc29uLnJlZGlyZWN0VXJpOwogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICBpZiAoIShzdWNjZXNzSnNvbi5zdGF0dXMgPT09IDIwMCAmJiBzdWNjZXNzSnNvbi5jb250ZW50KSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmICghKHN1Y2Nlc3NKc29uLmNhbGxiYWNrcyAmJiBzdWNjZXNzSnNvbi5jYWxsYmFja3MubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gODsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goJ2hhbmRsZVN1Y2Nlc3NDYWxsYmFja3MnLCBzdWNjZXNzSnNvbi5jYWxsYmFja3MpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzdWNjZXNzZnVsbHkgZXhlY3V0ZWQgYWxsIGZvcm0gY2FsbGJhY2tzIik7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSg4KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuY29tbWl0KCdzZXRGb3JtUmVzcG9uc2UnLCAiPGgxPm9uZSBvZiB0aGUgZm9ybSBjYWxsYmFja3MgZmFpbGVkLCBjaGVjayBjb25zb2xlIGZvciBtb3JlIGluZm88L2gxPlxuICAgICAgICAgICAgICAgICAgPGgyPiIuY29uY2F0KF9jb250ZXh0Mi50MCwgIjwvaDI+IikpKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgICBjb250ZXh0LmNvbW1pdCgnc2V0Rm9ybVJlc3BvbnNlJywgc3VjY2Vzc0pzb24uY29udGVudCk7CiAgICAgICAgICAgICAgICAgIGNvbnRleHQuY29tbWl0KCdzZXRGb3JtRmluaXNoZWQnKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICAgIGlmICghc3VjY2Vzc0pzb24uYXBpKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKCEoc3VjY2Vzc0pzb24uYXBpLmNhbGxiYWNrcyAmJiBzdWNjZXNzSnNvbi5hcGkuY2FsbGJhY2tzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMxOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDIyOwogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgnaGFuZGxlU3VjY2Vzc0NhbGxiYWNrcycsIHN1Y2Nlc3NKc29uLmFwaS5jYWxsYmFja3MpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzdWNjZXNzZnVsbHkgZXhlY3V0ZWQgYWxsIHN0ZXAgY2FsbGJhY2tzIik7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMjg7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MSA9IF9jb250ZXh0MlsiY2F0Y2giXSgyMik7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LmNvbW1pdCgnc2V0Rm9ybVJlc3BvbnNlJywgIjxoMT5vbmUgb2YgdGhlIHN0ZXAgY2FsbGJhY2tzIGZhaWxlZCwgY2hlY2sgY29uc29sZSBmb3IgbW9yZSBpbmZvPC9oMT5cbiAgICAgICAgICAgICAgICAgIDxoMj4iLmNvbmNhdChfY29udGV4dDIudDEsICI8L2gyPiIpKSk7CgogICAgICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImxvYWRpbmcgbmV4dCBzdGVwIik7CiAgICAgICAgICAgICAgICAgIGNvbnRleHQuY29tbWl0KCdzZXRGb3JtU3RlcCcsIHN1Y2Nlc3NKc29uKTsKCiAgICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzgsIDE0XSwgWzIyLCAyOF1dKTsKICAgICAgICB9KSkoKTsKICAgICAgfSwKICAgICAgaGFuZGxlU3VjY2Vzc0NhbGxiYWNrczogZnVuY3Rpb24gaGFuZGxlU3VjY2Vzc0NhbGxiYWNrcyhfY29udGV4dCwgY2FsbGJhY2tBcnJheSkgewogICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgICAgdmFyIGNyZWF0ZWRDYWxsYmFja0xpc3Q7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MykgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBjcmVhdGVkQ2FsbGJhY2tMaXN0ID0gY3JlYXRlQ2FsbGJhY2tMaXN0KGNhbGxiYWNrQXJyYXkpOwoKICAgICAgICAgICAgICAgICAgaWYgKCEoIWNyZWF0ZWRDYWxsYmFja0xpc3QgfHwgIWNyZWF0ZWRDYWxsYmFja0xpc3QubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIFByb21pc2UuYWxsKGNyZWF0ZWRDYWxsYmFja0xpc3QpKTsKCiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgICB9KSkoKTsKICAgICAgfQogICAgfQogIH0pOwp9OwovKiBzaG91bGQgbWF5YmUgZ2VuZXJhdGUgZXJyb3IgaGFuZGxlcnMgYW5kIGZpbmlzaGVycyBvbmNlIG9uIHN0YXJ0IGluc3RlYWQgb2YgaW4gZXZlcnkgaW5wdXQgY29tcG9uZW50ICovCgovKiB0cnkgdG8gZmxhdHRlbiB0aGUgZGF0YSBhcyBtdWNoIGFzIHBvc3NpYmxlLiBSZXBlYXRpbmcgZGF0YSBpcyBmaW5lICovCgoKZnVuY3Rpb24gaW5pdEZvcm1TdGF0ZUZyb21FeHRlbmRlZEZvcm0oZm9ybURhdGEpIHsKICB2YXIgZm9ybUNvbmZpZyA9IGZvcm1EYXRhLmNvbmZpZ3VyYXRpb247CiAgaWYgKCFmb3JtQ29uZmlnKSByZXR1cm4ge307CiAgdmFyIHN0YXRlID0gewogICAgaWQ6IGZvcm1Db25maWcuaWQsCiAgICBjdXJyZW50U3RlcDogZm9ybUNvbmZpZy5hcGkucGFnZS5jdXJyZW50IHx8IDEsCiAgICBuZXh0U3RlcDogZm9ybUNvbmZpZy5hcGkucGFnZS5uZXh0UGFnZSB8fCAxLAogICAgcHJldmlvdXNTdGVwOiBmb3JtQ29uZmlnLmFwaS5wYWdlLnByZXZpb3VzUGFnZSB8fCAxLAogICAgbGFzdFN0ZXA6IGZvcm1Db25maWcuYXBpLnBhZ2UucGFnZXMgfHwgMSwKICAgIGZvcm1SZXNwb25zZTogbnVsbCwKICAgIGZvcm1GaW5pc2hlZDogZmFsc2UsCiAgICBzdGVwczogW2NyZWF0ZVN0ZXBGcm9tRm9ybUNvbmZpZyhmb3JtQ29uZmlnKV0KICB9OwogIHJldHVybiBzdGF0ZTsKfQoKZnVuY3Rpb24gY3JlYXRlU3RlcEZyb21Gb3JtQ29uZmlnKGZvcm1Db25maWcpIHsKICBjb25zb2xlLmxvZyhmb3JtQ29uZmlnKTsKICByZXR1cm4gewogICAgc2NoZW1hOiBPYmplY3QuZnJlZXplKGZvcm1Db25maWcpLAogICAgLy8gdGhlIG9yaWdpbmFsIHNoYXBlIG9mIHRoZSBmb3JtIHdpdGggYWxsIHRoZSBuZXN0aW5nIGZvciByZWNvbnN0cnVjdGlvbgogICAgaW5wdXRNb2RlbDogY3JlYXRlTW9kZWxGcm9tRm9ybUNvbmZpZyhpbnB1dEFycmF5RnJvbVNjaGVtYShmb3JtQ29uZmlnLmVsZW1lbnRzKSksCiAgICAvLyBhY3R1YWxseSByZWFjdGl2ZSBmb3JtIHN0YXRlCiAgICBmb3JtU3RlcEVycm9yOiBudWxsLAogICAgZm9ybUlkOiBmb3JtQ29uZmlnLmlkLAogICAgZm9ybUFjdGlvbjogZm9ybUNvbmZpZy5hY3Rpb24gfHwgJycsCiAgICB3YXNTdWJtaXR0ZWQ6IGZhbHNlCiAgfTsKfQoKZnVuY3Rpb24gY3JlYXRlTW9kZWxGcm9tRm9ybUNvbmZpZyhlbGVtZW50cykgewogIHZhciBtb2RlbCA9IHt9OwogIGlmICghZWxlbWVudHMgfHwgIUFycmF5LmlzQXJyYXkoZWxlbWVudHMpKSByZXR1cm4gbW9kZWw7CiAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgbW9kZWxbZWxlbWVudC5pZGVudGlmaWVyXSA9IHsKICAgICAgaWQ6IGVsZW1lbnQuaWRlbnRpZmllciwKICAgICAgdmFsdWU6IGVsZW1lbnQuZGVmYXVsdFZhbHVlIHx8ICIiLAogICAgICBoYXNFcnJvcjogZmFsc2UsCiAgICAgIGVycm9yTGlzdDogW10KICAgIH07CiAgfSk7CiAgcmV0dXJuIG1vZGVsOwp9IC8vIHJlY3Vyc2l2ZSBmdW5jdGlvbiB0aGF0IGdlbmVyYXRlcyBhIGZsYXQgYXJyYXkgb2Ygb25seSBpbnB1dHMgZnJvbSBhIG5lc3RlZCBmb3JtIHNjaGVtYQoKCmZ1bmN0aW9uIGlucHV0QXJyYXlGcm9tU2NoZW1hKGVsZW1lbnRzKSB7CiAgdmFyIGlucHV0cyA9IFtdOwogIGVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgIGlmIChlbGVtZW50LmVsZW1lbnRzICYmIGVsZW1lbnQuZWxlbWVudHMubGVuZ3RoKSB7CiAgICAgIGlucHV0cy5wdXNoLmFwcGx5KGlucHV0cywgX3RvQ29uc3VtYWJsZUFycmF5KGlucHV0QXJyYXlGcm9tU2NoZW1hKGVsZW1lbnQuZWxlbWVudHMpKSk7CiAgICB9IGVsc2UgaW5wdXRzLnB1c2goZWxlbWVudCk7CiAgfSk7CiAgcmV0dXJuIGlucHV0czsKfQoKZXhwb3J0IGRlZmF1bHQgY3JlYXRlU3RvcmU7"},{"version":3,"sources":["/Users/k.imamov/Desktop/json-formvue/json-formvue/src/store/index.js"],"names":["Vue","Vuex","createCallbackList","use","createStore","initialState","debug","process","env","NODE_ENV","Store","state","initFormStateFromExtendedForm","strict","getters","getCurrentStep","validIndex","currentStep","steps","getIsSingleStep","lastStep","getIsLastStep","getCurrentSchema","_","schema","getCurrentModel","inputModel","getCurrentInputValue","inputKey","model","value","getCurrentInputName","step","formId","mutations","updateInputValue","payload","console","log","currentModel","key","updateFormStep","newStep","setFormResponse","response","formResponse","setFormFinished","formFinished","setFormStep","formConfig","formConfigStep","api","page","current","id","nextStep","nextPage","previousStep","previousPage","pages","createStepFromFormConfig","actions","submitStep","context","vuetifyForm","isFormValid","validate","$el","formData","FormData","append","currentAction","formAction","fetch","method","body","then","status","json","Error","dispatch","catch","error","commit","message","handleSuccessResponse","successJson","redirectUri","window","location","content","callbacks","length","handleSuccessCallbacks","_context","callbackArray","createdCallbackList","Promise","all","configuration","Object","freeze","createModelFromFormConfig","inputArrayFromSchema","elements","formStepError","action","wasSubmitted","Array","isArray","forEach","element","identifier","defaultValue","hasError","errorList","inputs","push"],"mappings":"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","sourcesContent":["import Vue from 'vue';\nimport Vuex from 'vuex'\nimport { createCallbackList } from '../lib/util';\n\n\nVue.use(Vuex)\n\n\n/* look into splitting single step and multie step into different modules and conditionally adding them if needed */\nconst createStore=(initialState)=>{\n  const debug = process.env.NODE_ENV !== 'production'\n\n  return new Vuex.Store({\n    state: initFormStateFromExtendedForm(initialState),\n    strict: debug,\n    \n    getters: {\n      getCurrentStep: state => {\n        const validIndex=state.currentStep? state.currentStep - 1 : 0;\n        return state.steps[validIndex];\n      },\n      getIsSingleStep: state => {\n        return state.lastStep === 1\n      },\n      getIsLastStep: state => {\n        return state.currentStep === state.lastStep\n      },\n      getCurrentSchema: (_, getters) =>{\n        return getters.getCurrentStep.schema\n      },\n      getCurrentModel: (_, getters) =>{\n        return getters.getCurrentStep.inputModel\n      },\n      getCurrentInputValue: (_, getters) => inputKey =>{\n        const model=getters.getCurrentModel;\n        if(!model) return \"\"\n        const inputModel=model[inputKey];\n        if(!inputModel || !inputModel.value) return \"\"\n        return inputModel.value; \n      },\n      getCurrentInputName: (_, getters) => inputKey =>{\n        const step=getters.getCurrentStep;\n        if(!step || !step.formId) return `tx_form_formframework[${inputKey}]`\n        return `tx_form_formframework[${step.formId}][${inputKey}]`\n      }\n    },\n\n    mutations: {\n      updateInputValue (state, payload){\n        console.log(payload)  \n        const validIndex=state.currentStep? state.currentStep - 1 : 0;\n        const currentStep=state.steps[validIndex];\n        if(!currentStep) return console.log(`could not find the step ${state.currentStep} at the index ${validIndex}`);\n        \n        const currentModel=currentStep.inputModel[payload.key];\n        if(!currentModel) return console.log(`the model does not have a field with the key ${payload.key}`);\n        \n        currentModel.value=payload.value;\n        console.log(currentModel)\n      },\n      updateFormStep (state, newStep){\n        state.currentStep=newStep>0? newStep : 1;\n      },\n      setFormResponse (state, response) {\n        state.formResponse=response;\n      },\n      setFormFinished(state){\n        state.formFinished=true;\n      },\n      setFormStep(state, formConfig){\n        const formConfigStep=formConfig.api.page.current>0? formConfig.api.page.current : 1;\n       \n        state.id=formConfig.id\n        state.currentStep=formConfig.api.page.current || 1\n        state.nextStep=formConfig.api.page.nextPage || 1\n        state.previousStep=formConfig.api.page.previousPage || 1\n        state.lastStep=formConfig.api.page.pages || 1\n        state.formResponse=null\n        \n        state.steps[formConfigStep - 1]=createStepFromFormConfig(formConfig)\n        \n      }\n    },\n\n    actions: {\n\n      submitStep(context, vuetifyForm){\n        const isFormValid=vuetifyForm.validate();\n        \n        if(vuetifyForm.$el && isFormValid){ // check if form element exists and if it is valid\n          const formData=new FormData(vuetifyForm.$el); // parse formdata from underlying form element\n          \n          const currentModel=context.getters.getCurrentModel;\n          console.log(currentModel)\n          // append entries to formdata\n          formData.append(context.getters.getCurrentInputName('__currentPage'), currentModel['__currentPage'].value)\n          formData.append('tx_form_formframework[__trustedProperties]', currentModel['__trustedProperties'].value)\n          formData.append(context.getters.getCurrentInputName('__state'), currentModel['__state'].value)\n\n          const currentAction=context.getters.getCurrentStep.formAction;\n          if(!currentAction) return console.log(\"could not find valid action for the current step\")\n\n          fetch(currentAction,{ \n            method: \"POST\",\n            body: formData\n          })\n          .then(response=>{\n              if(response.status===200 || response.status===301) return response.json();\n              throw new Error('invalid status code. Only 200 and 301 allowed');\n            }\n          )\n          .then(json=> context.dispatch('handleSuccessResponse', json))\n          .catch(error=>{ // does not catch handleSuccessResponse errors\n            console.log(error);\n            context.commit(\n              'setFormResponse', \n              `<h1>request failed</h1>\n                <h2>${error.message}</h2>`\n            );\n          })\n\n        }\n      },\n\n\n      async handleSuccessResponse(context, successJson){\n        console.log(successJson);\n        if(!successJson) throw new Error('could not find valid json');\n        \n        // handle redirect on success\n        if(successJson.status===301 && successJson.redirectUri){\n          window.location=successJson.redirectUri;\n          return;\n        } \n\n        // handle replace content with success message\n        if(successJson.status===200 && successJson.content){ \n          if(successJson.callbacks && successJson.callbacks.length){\n            // if the response contains callbacks handle them before proceeding\n            try {\n              await context.dispatch('handleSuccessCallbacks', successJson.callbacks);\n              console.log(\"successfully executed all form callbacks\")\n            } catch (error) {\n              // if a callback fails return early \n              return context.commit(\n                'setFormResponse', \n                `<h1>one of the form callbacks failed, check console for more info</h1>\n                  <h2>${error}</h2>`\n              );\n            }\n          }\n          context.commit('setFormResponse', successJson.content);\n          context.commit('setFormFinished');\n          return;\n        }\n\n        // handle loading next page after finishing callbacks if needed\n        if(successJson.api){\n          if(successJson.api.callbacks && successJson.api.callbacks.length){\n            try {\n              await context.dispatch('handleSuccessCallbacks', successJson.api.callbacks);\n              console.log(\"successfully executed all step callbacks\")\n            } catch (error) {\n              return context.commit(\n                'setFormResponse', \n                `<h1>one of the step callbacks failed, check console for more info</h1>\n                  <h2>${error}</h2>`\n              );\n            }\n          }\n          console.log(\"loading next step\")\n          context.commit('setFormStep', successJson);\n        }\n        \n      },\n\n\n      async handleSuccessCallbacks(_context, callbackArray){\n        const createdCallbackList=createCallbackList(callbackArray);\n        if(!createdCallbackList || !createdCallbackList.length) return;\n\n        return Promise.all(createdCallbackList);\n\n      }\n    }\n\n  })\n}\n\n/* should maybe generate error handlers and finishers once on start instead of in every input component */\n/* try to flatten the data as much as possible. Repeating data is fine */\n\nfunction initFormStateFromExtendedForm(formData){\n  const formConfig=formData.configuration;\n  if(!formConfig) return {}\n  \n  const state={\n    id: formConfig.id,\n    currentStep: formConfig.api.page.current || 1,\n    nextStep: formConfig.api.page.nextPage || 1,\n    previousStep: formConfig.api.page.previousPage || 1,\n    lastStep: formConfig.api.page.pages || 1,\n    formResponse: null,\n    formFinished: false,\n\n\n    steps: [\n      createStepFromFormConfig(formConfig)\n    ]\n  }\n  return state;\n}\n\n\nfunction createStepFromFormConfig(formConfig){\n  console.log(formConfig)\n  return {\n    schema: Object.freeze(formConfig), // the original shape of the form with all the nesting for reconstruction\n    inputModel: createModelFromFormConfig(inputArrayFromSchema(formConfig.elements)),  // actually reactive form state\n    \n    formStepError: null,\n    formId: formConfig.id,\n    formAction: formConfig.action || '',\n    wasSubmitted: false\n  }\n}\n\nfunction createModelFromFormConfig(elements){\n  const model={};\n  if(!elements || !Array.isArray(elements)) return model;\n  \n  elements.forEach(element=>{\n    model[element.identifier]={\n      id: element.identifier,\n      value: element.defaultValue || \"\",\n      hasError: false,\n      errorList: []\n    }\n  })\n  return model;\n}\n\n\n// recursive function that generates a flat array of only inputs from a nested form schema\nfunction inputArrayFromSchema(elements){\n  const inputs=[];\n\n  elements.forEach(element=>{\n    if(element.elements && element.elements.length){\n      inputs.push(...inputArrayFromSchema(element.elements));\n    }\n    else inputs.push(element)\n  })\n\n  return inputs;\n}\n\n\nexport default createStore;\n"]}]}